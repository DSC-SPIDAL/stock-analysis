#!/bin/sh
GLOBAL_VECS=$BASE_DIR/$GLOBAL_VEC_DIR_NAME
GLOBAL=$BASE_DIR/$GLOBAL_STOCK_DIR_NAME
ORIGINAL_STOCK_FILE=$GLOBAL/$STOCK_FILE_NAME
#CAT_FILE=$BASE_DIR/all_companylist.csv
CAT_FILE=$BASE_DIR/$HIST_DIR_NAME
GLOBAL_POINTS=$BASE_DIR/$GLOBAL_POINTS_DIR_NAME
CONT_VECS=$BASE_DIR/$VECS_DIR_NAME
CONT_POINTS=$BASE_DIR/$POINTS_DIR_NAME
GLOBAL_CONT_COMMON_POINTS=$BASE_DIR/$GLOBAL_COMMON_POINTS_DIR_NAME
CONT_COMMON_POINTS=$BASE_DIR/$COMMON_POINTS_DIR_NAME
HIST_DIR=$BASE_DIR/$HIST_DIR_NAME
GLOBAL_HIST_DIR=$BASE_DIR/$GLOBAL_HIST_DIR_NAME

# rotate the points
# ******************
ROTATE_POINTS=$CONT_COMMON_POINTS/*
ROTATE_POINT_DIR=$CONT_COMMON_POINTS
ROTATE_BASE_FILE=$GLOBAL_CONT_COMMON_POINTS/$STOCK_FILE_NAME
ROTATE_OUT=$BASE_DIR/$ROTATE_OUT_DIR_NAME
ROTATE_CONTROL=$ROTATE_OUT/rotate_control
FULL_POINTS=$CONT_POINTS

FINAL_ROTATE_SUMMARY=$BASE_DIR/$ROTATE_FINAL_SUMMARY_DIR_NAME
FINAL_ROTATE=$BASE_DIR/$ROTATE_FINAL_DIR_NAME

LABEL_OUT=$BASE_DIR/$LABEL_OUT_DIR_NAME
mkdir -p $LABEL_OUT
echo "APPLY HIST LABELS"
java -cp ../mpi/target/stocks-1.0-ompi1.8.1-jar-with-dependencies.jar LabelApply \
-v $CONT_VECS \
-p $FINAL_ROTATE \
-d $LABEL_OUT \
-o $ORIGINAL_STOCK_FILE \
-s $HIST_DIR -h \
-e fixedclasses.txt \
-ci clusters.xml \
-co $BASE_DIR/$LABELED_FINAL_DIR_NAME/histo_clusters.xml

GLOBAL_LABEL_OUT=$BASE_DIR/$GLOBAL_LABEL_OUT_DIR_NAME
mkdir -p $GLOBAL_LABEL_OUT
echo "APPLY GLOABL HIST LABELS"
java -cp ../mpi/target/stocks-1.0-ompi1.8.1-jar-with-dependencies.jar LabelApply \
-v $BASE_DIR/$GLOBAL_VEC_DIR_NAME \
-p $BASE_DIR/$GLOBAL_POINTS_DIR_NAME \
-d $GLOBAL_LABEL_OUT \
-o $ORIGINAL_STOCK_FILE \
-s $GLOBAL_HIST_DIR -h \
-e fixedclasses.txt \
-ci clusters.xml \
-co $BASE_DIR/$LABELED_FINAL_DIR_NAME/histo_global_clusters.xml

#echo "APPLY SECTOR LABELS"
#SEC_LABEL_OUT=$BASE_DIR/$SECTOR_LABEL_OUT_DIR_NAME
#mkdir -p $SEC_LABEL_OUT
#SEC_FILE=$BASE_DIR/$GLOBAL_STOCK_DIR_NAME/all_companylist.csv
#
#java -cp ../mpi/target/stocks-1.0-ompi1.8.1-jar-with-dependencies.jar LabelApply \
#-v $CONT_VECS \
#-p $FINAL_ROTATE \
#-d $SEC_LABEL_OUT \
#-o $ORIGINAL_STOCK_FILE \
#-s $SEC_FILE \
#-e fixedclasses.txt \
#-ci sector_clusters.xml \
#-co $BASE_DIR/$LABELED_FINAL_DIR_NAME/sector_clusters.xml
#
#
#echo "APPLY GLOBAL SECTOR LABELS"
#GLOBAL_SEC_LABEL_OUT=$BASE_DIR/$GLOBAL_SECTOR_LABEL_OUT_DIR_NAME
#mkdir -p $GLOBAL_SEC_LABEL_OUT
#java -cp ../mpi/target/stocks-1.0-ompi1.8.1-jar-with-dependencies.jar LabelApply \
#-v $BASE_DIR/$GLOBAL_VEC_DIR_NAME \
#-p $BASE_DIR/$GLOBAL_POINTS_DIR_NAME \
#-d $GLOBAL_SEC_LABEL_OUT \
#-o $ORIGINAL_STOCK_FILE \
#-s $SEC_FILE \
#-e fixedclasses.txt \
#-ci sector_clusters.xml \
#-co $BASE_DIR/$LABELED_FINAL_DIR_NAME/sector_global_clusters.xml
